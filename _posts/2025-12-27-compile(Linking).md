0---
title: "Compile(Linking)"
excerpt: "컴파일 과정 중 링킹에 대해서 다룹니다."

categories:
  - Compile
tags:
  - [Compile, linking]

permalink: /Compile/linking

toc: true
toc_sticky: true

date: 2025-12-28
last_modified_at: 2025-12-28
---

## 링킹(Linking)
***
링킹과정은 크게 다음과 같습니다.
   
- 심볼 해석, 참조 정의 매핑
- 섹션 병합/배치, 최종 주소 결정
- relocation을 통해 코드/데이터를 ABI규칙에 따라 패치, 실행 가능 바이너리 완성
   
이를 통한 목적은 크게 두 가지로 나뉩니다.
   
- 서로 다른 번역 단위(translation unit)에서 발생한 심볼 참조(symbol reference)를 정의(definition)에 연결
- 코드/데이터를 최종 레이아웃으로 배치, 기계어 내부의 주소 필드를 재배치(relocation)로 패치, 실행 가능 바이너리로 완성
   
링킹에서의 입력/출력 아티펙트
   
#### 입력
   
- 오브젝트 파일 : 각 소스 파일이 컴파일/어셈블된 결과. 섹션과 심볼, relocation 정보를 포함
- 정적 라이브러리 : 여러 오브젝트 파일의 묶음(아카이브)
- 공유 라이브러리 : 런타임 로더가 적재할 수 있는 동적 로딩 대상
   
#### 출력
   
- 실행 파일(ELF/PE 등) : 코드/데이터 섹션 + 엔트리 포인트 + 로더 정보
- 공유 라이브러리(ELF .so, PE . dll 등) : 동적 로딩/심볼 내보내기(export) 메타 데이터 포함
- 링크 맵/심볼 맵 : 레이아웃/심볼 주소 추적용

##### 용어 정리

- 섹션 : 컴파일러/어셈블러가 생성한 논리 조각(.text, .rodata, .data, .bss 등)
- 세그먼트 : 로더가 메모리에 매핑하는 단위(RX 코드, R 읽기전용 데이터, RW 데이터)
   
> 링커는 섹션들을 합쳐 세그먼트로 재구성, 메모리에 어떤 보호 속성으로 배치될지에 대해서도 반영합니다.
   
- 정의 심볼(defined) : 해당 오브젝트가 실제로 제공하는 함수/전역 데이터
- 미해결 심볼(undefined) : 외부에서 반드시 제공되어야 하는 참조
- 가시성/바인딩 : 외부로 노출되는지(링크 가능 범위), 강한/약한 정의(weak/strong) 같은 결합 규칙
- 재배치 : 기계어/데이터 내 이 위치에 이후 주소를 채워 넣어야 한다는 내용 표기(링커가 최종 주소 확정 후 해당 위치를 패치합니다)
   

